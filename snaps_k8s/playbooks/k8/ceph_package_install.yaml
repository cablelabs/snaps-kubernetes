- name: deleting already existing directory
  become: yes
  become_method: sudo
  become_user: root
  file:
   state: absent
   path: "{{ PROJ_ARTIFACT_DIR }}/cluster-ceph"
  ignore_errors: true

- name: Install the trusted key with wget -q -O- 'https://download.ceph.com/keys/release.asc' | sudo apt-key add -
  become: yes
  become_method: sudo
  become_user: root
  shell: wget -q -O- 'https://download.ceph.com/keys/release.asc' | sudo apt-key add -
  register: cat
- debug: var=cat.stdout_lines

- name: Add Ceph repository to apt configuration
  become: yes
  become_method: sudo
  become_user: root
  command: echo deb http://download.ceph.com/debian-jewel/ $(lsb_release -sc) main | sudo tee /etc/apt/sources.list.d/ceph.list
  register: cat
- debug: var=cat.stdout_lines

- name: Update Packages
  become: yes
  become_method: sudo
  become_user: root
  shell: sudo apt-get -qqy update && sudo apt-get install -qqy ceph-deploy

- name: create directory cluster-ceph
  file:
    state: directory
    path: "{{ PROJ_ARTIFACT_DIR }}/cluster-ceph"
